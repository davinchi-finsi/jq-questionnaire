/**
 * @license jq-quiz v1.0.0
 * (c) 2018 Finsi, Inc.
 */

!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s():"function"==typeof define&&define.amd?define(s):s()}(0,function(){"use strict";$.widget("ui.jqQuiz",{NAMESPACE:"jqQuiz",QUERY_HEADER:"[data-jq-quiz-header]",QUERY_WRAPPER:"[data-jq-quiz-wrapper]",QUERY_BODY:"[data-jq-quiz-body]",QUERY_PROPERTIES:"[data-jq-quiz-properties]",QUERY_QUESTIONS:"[data-jq-quiz-questions]",QUERY_QUESTION:"[data-jq-quiz-question]",QUERY_OPTIONS:"[data-jq-quiz-options]",QUERY_OPTION:"[data-jq-quiz-option]",QUERY_ACTION_START:"[data-jq-quiz-start]",QUERY_ACTION_NEXT:"[data-jq-quiz-next]",QUERY_ACTION_PREV:"[data-jq-quiz-prev]",QUERY_ACTION_END:"[data-jq-quiz-end]",QUERY_RENDER_OPTION:"[data-jq-quiz-property]",QUERY_RENDER_RESULT:"[data-jq-quiz-result-item]",QUERY_RESULT:"[data-jq-quiz-result]",QUERY_FEEDBACK:"[data-jq-quiz-feedback]",IS_CORRECT:"isCorrect",ATTR_CURRENT_QUESTION:"data-current-question",ATTR_IS_CORRECT:"data-is-correct",ATTR_POINTS_FOR_SUCCESS:"data-points-for-success",ATTR_FEEDBACK:"data-jq-quiz-feedback",ATTR_POINTS_FOR_FAIL:"data-points-for-fail",ON_QUESTION_HIDE:"jqQuiz:questionHide",ON_QUESTION_SHOW:"jqQuiz:questionShow",ON_HEADER_HIDE:"jqQuiz:headerHide",ON_HEADER_SHOW:"jqQuiz:headerShow",ON_BODY_HIDE:"jqQuiz:bodyHide",ON_BODY_HIDDEN:"jqQuiz:bodyHidden",ON_BODY_SHOW:"jqQuiz:bodyShow",ON_BODY_SHOWN:"jqQuiz:bodyShown",ON_TRANSITION_END:"jqQuiz:transitionEnd",ON_OPTION_CHANGE:"jqQuiz:questionChange",ON_START:"jqQuiz:start",ON_STARTED:"jqQuiz:started",ON_END:"jqQuiz:end",FEEDBACK_TYPES:{ok:"ok",ko:"ko"},STATES:{off:0,running:1,result:2,review:3},DISABLE_END:{never:0,beforeAnswerAll:1,beforeAnswerAllCorrect:2},options:{classes:{firstQuestion:"jq-quiz--first-question",lastQuestion:"jq-quiz--last-question",widget:"jq-quiz",questionCorrect:"jq-quiz--correct",questionIncorrect:"jq-quiz--incorrect",selected:"jq-quiz--selected",stateResult:"jq-quiz--result",stateReview:"jq-quiz--review",stateRunning:"jq-quiz--running",multichoice:"jq-quiz--multi-choice",wrapper:"jq-quiz__form",header:"jq-quiz__header",body:"jq-quiz__body",startBtn:"jq-quiz__start",nextBtn:"jq-quiz__next",prevBtn:"jq-quiz__prev",endBtn:"jq-quiz__end",result:"jq-quiz__result",question:"jq-quiz__question",option:"jq-quiz__option",navbar:"jq-quiz__navbar",button:"jq-quiz__action",properties:"jq-quiz__properties",questions:"jq-quiz__questions",disabled:"jq-quiz--disabled"},delayOnAutoNext:500,pointsForSuccess:1,pointsForFail:0,cutOffMark:50,immediateFeedback:!1,disableOptionAfterSelect:!0,allowChangeOption:!1,autoGoNext:!0,showCorrection:!0,showResult:!0,multichoice:!1,disableNextUntilSuccess:!1,disableEndActionUntil:0,dialog:{draggable:!1,autoOpen:!0,resizable:!1,modal:!0},initialQuestion:0,autoStart:!1},_create:function(){this._getElements(),this.element.uniqueId(),this._mapQuestions(),this._changeState(this.STATES.off),this._assignEvents(),this._renderOptions(),this.options.autoStart&&this.start()},_renderOptions:function(){this._renderVar(this.QUERY_RENDER_OPTION,"jqQuizProperty")},_renderVar:function(t,s,i,e){e=e||this.element,i=i||this.options;for(var n,o,a=0,r=e.find(t);a<r.length;a++){var h=r[a],d=$(h),l=d.data(s)||"",u=void 0,c=void 0;if(void 0!=l){l=(n=l.split("?"))[0],u=n[1],l=l.trim(),void 0!=u&&(u=(o=u.split(":"))[0],c=o[1],u.trim(),c.trim());var _=i[l];_=void 0!=_?_:"",void 0!=u&&_?_=u:void 0==c||_||(_=c),d.html(_)}}},_getElements:function(){this._$wrapper=this.element.find(this.QUERY_WRAPPER).addClass(this.options.classes.wrapper),this._$header=this.element.find(this.QUERY_HEADER).addClass(this.options.classes.header),this._$body=this.element.find(this.QUERY_BODY).addClass(this.options.classes.body),this._$body.hide(),this._$properties=this.element.find(this.QUERY_PROPERTIES).addClass(this.options.classes.properties),this._$questionsWrapper=this.element.find(this.QUERY_QUESTIONS).addClass(this.options.classes.questions),this._$questions=this._$questionsWrapper.find(this.QUERY_QUESTION).addClass(this.options.classes.question),this._$questions.hide(),this._$startBtn=this._$wrapper.find(this.QUERY_ACTION_START).addClass(this.options.classes.button+" "+this.options.classes.startBtn),this._$nextBtn=this._$wrapper.find(this.QUERY_ACTION_NEXT).addClass(this.options.classes.button+" "+this.options.classes.nextBtn),this._$prevBtn=this._$wrapper.find(this.QUERY_ACTION_PREV).addClass(this.options.classes.button+" "+this.options.classes.prevBtn),this._$endBtn=this._$wrapper.find(this.QUERY_ACTION_END).addClass(this.options.classes.button+" "+this.options.classes.endBtn),this._$result=this._$wrapper.find(this.QUERY_RESULT).addClass(this.options.classes.result),this._$result.hide()},_mapQuestions:function(){var t=this._$questions.find(this.QUERY_OPTION).find(":checkbox");t.length>0?(t.attr("type","checkbox"),this.options.multichoice=!0,this.element.addClass(this.options.classes.multichoice)):t.attr("type","radio");for(var s=this._$questions,i=[],e={},n=0,o=0,a=s.length;o<a;o++){var r=$(s[o]),h=this._mapQuestion(r);i.push(h),e[h.id]=o,n+=h.pointsForSuccess}this._questions=i,this._questionsMap=e,this._maxScore=n,this._setOption("maxScore",n)},_mapQuestion:function(t){var s,i=t.find(this.QUERY_OPTIONS),e=i.find(this.QUERY_OPTION),n=e.first().find("input").attr("name"),o=t.data(this.ATTR_POINTS_FOR_SUCCESS),a=t.data(this.ATTR_POINTS_FOR_FAIL),r=this._mapOptions(e),h=r.arr,d=r.map,l=t.find(this.QUERY_FEEDBACK).not(this.QUERY_OPTION+" "+this.QUERY_FEEDBACK);l.hide(),t.removeAttr(this.ATTR_POINTS_FOR_FAIL),t.removeAttr(this.ATTR_POINTS_FOR_SUCCESS),t.uniqueId(),s=t.attr("id"),n=void 0!=n?n:s,e.find("input").attr("name",n);for(var u={id:s,$element:t,$optionsWrapper:i,$options:e,options:h,optionsMap:d,pointsForSuccess:void 0!=o?o:this.options.pointsForSuccess,pointsForFail:void 0!=a?a:this.options.pointsForFail},c=0,_=l;c<_.length;c++){var p=_[c],f=$(p);switch(f.attr(this.ATTR_FEEDBACK)){case this.FEEDBACK_TYPES.ok:u.$feedbackOk=f;break;case this.FEEDBACK_TYPES.ko:u.$feedbackKo=f;break;default:u.$feedback=f}}return u.$feedbackOk=u.$feedbackOk||u.$feedback||$(null),u.$feedbackKo=u.$feedbackKo||u.$feedback||$(null),u},_mapOptions:function(t){for(var s=[],i={},e=0,n=t.length;e<n;e++){var o=$(t[e]),a=this._mapOption(o);s.push(a),i[a.id]=e}return{arr:s,map:i}},_mapOption:function(t){var s=!!t.data(this.IS_CORRECT),i=t.find(this.QUERY_FEEDBACK);t.removeAttr(this.ATTR_IS_CORRECT),t.uniqueId();for(var e={id:t.attr("id"),$element:t,isCorrect:s},n=0,o=i;n<o.length;n++){var a=o[n],r=$(a);switch(r.attr(this.ATTR_FEEDBACK)){case this.FEEDBACK_TYPES.ok:e.$feedbackOk=r;break;case this.FEEDBACK_TYPES.ko:e.$feedbackKo=r;break;default:e.$feedback=r}}return e.$feedbackOk=e.$feedbackOk||e.$feedback||$(null),e.$feedbackKo=e.$feedbackKo||e.$feedback||$(null),i.hide(),e},_assignEvents:function(){this._$startBtn.off(this.NAMESPACE).on("click."+this.NAMESPACE,{instance:this},this._onStartButtonClick),this._$endBtn.off(this.NAMESPACE).on("click."+this.NAMESPACE,{instance:this},this._onEndButtonClick),this._$nextBtn.off(this.NAMESPACE).on("click."+this.NAMESPACE,{instance:this},this._onNextButtonClick),this._$prevBtn.off(this.NAMESPACE).on("click."+this.NAMESPACE,{instance:this},this._onPrevButtonClick),this._$questions.off(this.NAMESPACE).on("change."+this.NAMESPACE,{instance:this},this._onOptionChange)},_onStartButtonClick:function(t){t.preventDefault(),t.data.instance.start()},_onEndButtonClick:function(t){t.preventDefault(),t.data.instance.end()},_onNextButtonClick:function(t){t.preventDefault(),t.data.instance.next()},_onPrevButtonClick:function(t){t.preventDefault(),t.data.instance.prev()},_calificate:function(){var t,s,i=0,e=this._maxScore,n=(this._runtime,this._questions),o=0,a=0;1!=this.options.multichoice?(o=(s=this._calificateSingleChoice()).nSuccess,a=s.nFails,i=s.score):(o=(s=this._calificateMultiChoice()).nSuccess,a=s.nFails,i=s.score);return(t={maxScore:e,score:i,percentage:100*i/e,questionsSuccess:o,questionsFail:a,questionsNotAttempted:n.length-(o+a)}).success=t.percentage>=this.options.cutOffMark,t},_calificateSingleChoice:function(){for(var t=0,s=this._runtime,i=this._questions,e=0,n=0,o=0,a=i.length;o<a;o++){var r=i[o],h=(s[r.id],this._calificateSingleChoiceQuestion(r.id));void 0!=h&&(h?(t+=r.pointsForSuccess,e++):(n++,t>=r.pointsForFail&&(t-=r.pointsForFail)))}return{nSuccess:e,nFails:n,score:t}},_calificateSingleChoiceQuestion:function(t){var s,i=this.getQuestionById(t);if(i){var e=this._runtime[i.id];if(e&&e.options.length>0)s=i.options[i.optionsMap[e.options[0]]].isCorrect,e.isCorrect=s}return s},_calificateMultiChoiceQuestion:function(t){var s,i=this.getQuestionById(t);if(i){var e=this._runtime[i.id];if(e){for(var n=i.options,o=e.options,a=0,r=0,h=0,d=0,l=n.length;d<l;d++){var u=n[d],c=-1!=o.indexOf(u.id);u.isCorrect?(r++,a+=c?1:0):c&&(h++,d=l)}s=0==h&&a==r,e.isCorrect=s}}return s},_calificateMultiChoice:function(){for(var t=0,s=this._runtime,i=this._questions,e=0,n=0,o=0,a=i.length;o<a;o++){var r=i[o],h=(s[r.id],this._calificateMultiChoiceQuestion(r.id));void 0!=h&&(h?(e++,t+=r.pointsForSuccess):(n++,t>=r.pointsForFail&&(t-=r.pointsForFail)))}return{nSuccess:e,nFails:n,score:t}},_showOptionStatus:function(t,s){var i=this.getQuestionById(t);if(i){var e=this._runtime[i.id],n=i.options[i.optionsMap[s]];if(e&&n)-1!=e.options.indexOf(s)?n.$element.addClass(n.isCorrect?this.options.classes.questionCorrect:this.options.classes.questionIncorrect):n.$element.addClass(n.isCorrect?this.options.classes.questionIncorrect:"");else n.$element.addClass(n.isCorrect?this.options.classes.questionIncorrect:"")}},_showQuestionStatus:function(t){var s=this.getQuestionById(t);if(s){var i=this._runtime[s.id];if(i&&void 0!=i.option){var e=s.options;i.isCorrect?s.$element.addClass(this.options.classes.questionCorrect):s.$element.addClass(this.options.classes.questionIncorrect);for(var n=0,o=e;n<o.length;n++){var a=o[n];a.isCorrect?a.$element.addClass(this.options.classes.questionCorrect):a.$element.addClass(this.options.classes.questionIncorrect)}}}},_showOptionFeedback:function(t,s){var i=this.getQuestionById(t);if(i){var e=this._runtime[i.id],n=i.options[i.optionsMap[s]];if(e&&n)-1!=e.options.indexOf(s)&&(n.isCorrect?(n.$feedbackKo.hide(),n.$feedbackOk.show()):(n.$feedbackOk.hide(),n.$feedbackKo.show()))}},_showQuestionFeedback:function(t){var s=this.getQuestionById(t);if(s){var i=this._runtime[s.id];if(i&&void 0!=i)this.getOptionById(t,i.options[0]).isCorrect?(s.$feedbackKo.hide(),s.$feedbackOk.show()):(s.$feedbackOk.hide(),s.$feedbackKo.show())}},_disableQuestionOptionsField:function(t){var s=this.getQuestionById(t);if(s)if(this.options.multichoice&&this._state==this.STATES.running){s.$element.find(":checked").attr("disabled","disabled");for(var i=0,e=s.options;i<e.length;i++){var n=e[i];n.$element.find(":checked").length>0&&n.$element.addClass(this.options.classes.disabled)}}else s.$element.addClass(this.options.classes.disabled),s.$options.addClass(this.options.classes.disabled),s.$element.find("input").attr("disabled","disabled")},_onOptionClick:function(t){var s=t.data.instance,i=$(this).attr("id"),e=s._runtime[i]||{};!0===s.options.immediateFeedback&&void 0!=e.option&&t.preventDefault()},_onOptionChange:function(t){var s=t.data.instance;if(1!=s.options.disabled&&s._state==s.STATES.running){var i=$(t.target).parents(s.QUERY_OPTION),e=$(this).attr("id"),n=s._runtime[e]||{},o=n.options||[],a=n.optionsValues||[],r=i.attr("id"),h=i.find("input").attr("value");n.options=o,n.optionsValues=a,s._runtime[e]=n,s.options.multichoice?(t.target.checked?(o.push(r),h&&a.push(h),i.addClass(s.options.classes.selected)):(s._resetOption(e,r),o.splice(o.indexOf(r),1),h&&a.splice(a.indexOf(h),1)),s._calificateMultiChoiceQuestion(e)):(n.options.length>0&&s._resetOption(e,n.options[0]),o[0]=r,h&&(a[0]=h),i.addClass(s.options.classes.selected),s._calificateSingleChoiceQuestion(e)),1!=s.options.allowChangeOption&&s._disableQuestionOptionsField(e),1==s.options.immediateFeedback&&(void 0!=s.options.allowChangeOption&&1!=s.options.allowChangeOption||1==s.options.disableOptionAfterSelect?s._disableQuestionOptionsField(e):1==s.options.disableNextUntilSuccess&&s._updateNavigationActionsStates(),s._showQuestionStatus(e),s._showOptionStatus(e,r),s._showOptionFeedback(e,r),s._showQuestionFeedback(e,r)),0!=s.options.autoGoNext&&1!=s.options.multichoice&&setTimeout(function(){s.next()},s.options.delayOnAutoNext),s.element.triggerHandler(s.ON_OPTION_CHANGE,[s,e,r,h,n])}},_resetOption:function(t,s){var i=this.getQuestionById(t);if(i){var e=i.options[i.optionsMap[s]];e&&(e.$feedbackKo.hide(),e.$feedbackOk.hide(),e.$element.removeClass(this.options.classes.selected+" "+this.options.classes.questionCorrect+" "+this.options.classes.questionIncorrect))}},_setOption:function(t,s){this._super(t,s),"disabled"===t&&(s?this._disable():this._enable())},_hide:function(t){var s=this,i=$.Deferred(),e=this.element.triggerHandler(this.ON_QUESTION_HIDE,[this,t]);return void 0!=e&&e.hasOwnProperty("then")?e.then(function(){s.element.triggerHandler(s.ON_QUESTION_HIDDEN,[s,t]),i.resolveWith(s)}):t.fadeOut(400,function(){s.element.triggerHandler(s.ON_QUESTION_HIDDEN,[s,t]),i.resolveWith(s)}),i.promise()},_show:function(t){var s=this,i=$.Deferred(),e=this.element.triggerHandler(this.ON_QUESTION_SHOW,[this,t]);return void 0!=e&&e.hasOwnProperty("then")?e.then(function(){s.element.triggerHandler(s.ON_QUESTION_SHOWN,[s,t]),i.resolveWith(s)}):t.fadeIn(400,function(){s.element.triggerHandler(s.ON_QUESTION_SHOWN,[s,t]),i.resolveWith(s)}),i.promise()},_onHeaderHidden:function(t){t.resolveWith(this)},_hideHeader:function(){var t=$.Deferred();if(this._$header.length>0){var s=this.element.triggerHandler(this.ON_HEADER_HIDE,[this,this._$header]);void 0!=s&&s.hasOwnProperty("then")?s.then(this._onHeaderHidden.bind(this,t)):this._$header.fadeOut(400,this._onHeaderHidden.bind(this,t))}else this._onHeaderHidden(t);return t.promise()},_showHeader:function(){var t=this,s=$.Deferred();if(this._$header.length>0){var i=this.element.triggerHandler(this.ON_HEADER_SHOW,[this,this._$header]);void 0!=i&&i.hasOwnProperty("then")?i.then(function(){s.resolveWith(t)}):this._$header.fadeIn(400,function(){s.resolveWith(t)})}else s.resolveWith(this);return s.promise()},_onBodyHidden:function(t){t.resolveWith(this)},_hideBody:function(){var t=$.Deferred(),s=this.element.triggerHandler(this.ON_BODY_HIDE,[this,this._$body]);return void 0!=s&&s.hasOwnProperty("then")?s.then(this._onBodyHidden.bind(this,t)):this._$body.fadeOut(400,this._onBodyHidden.bind(this,t)),t.promise()},_showBody:function(){var t=this,s=$.Deferred(),i=this.element.triggerHandler(this.ON_BODY_SHOW,[this,this._$body]);return void 0!=i&&i.hasOwnProperty("then")?i.then(function(){s.resolveWith(t)}):this._$body.fadeIn(400,function(){s.resolveWith(t)}),s.promise()},_animationStart:function(){var t=this,s=$.Deferred(),i=this;return this._hideHeader().then(function(){t._showBody().then(function(){s.resolveWith(i)})}),s.promise()},_animationStop:function(){var t=this,s=$.Deferred(),i=this;return this._hideBody().then(function(){t._showHeader().then(function(){s.resolveWith(i)})}),s.promise()},_disableEnd:function(){this._$endBtn.prop("disabled",!0),this._$endBtn.addClass(this.options.classes.disabled)},_enableEnd:function(){this._$endBtn.prop("disabled",!1),this._$endBtn.removeClass(this.options.classes.disabled)},_disablePrev:function(){this._$prevBtn.prop("disabled",!0),this._$prevBtn.addClass(this.options.classes.disabled)},_enablePrev:function(){this._$prevBtn.prop("disabled",!1),this._$prevBtn.removeClass(this.options.classes.disabled)},_disableNext:function(){this._$nextBtn.prop("disabled",!0),this._$nextBtn.addClass(this.options.classes.disabled)},_enableNext:function(){this._$nextBtn.prop("disabled",!1),this._$nextBtn.removeClass(this.options.classes.disabled)},_disableStart:function(){this._$startBtn.prop("disabled",!0),this._$startBtn.addClass(this.options.classes.disabled)},_enableStart:function(){this._$startBtn.prop("disabled",!1),this._$startBtn.removeClass(this.options.classes.disabled)},_onAnimationStartEnd:function(){void 0!=this.options.initialQuestion&&this.goTo(this.options.initialQuestion),this.element.trigger(this.ON_STARTED,[this])},_onAnimationEndEnd:function(){this.reset()},_onQuestionTransitionEnd:function(t,s,i){this._updateNavigationActionsStates(),i.resolveWith(this),this.element.triggerHandler(this.ON_TRANSITION_END,[this,t,s])},_updateNavigationActionsStates:function(){var t=this.getQuestionByIndex(this._currentQuestionIndex),s=this._runtime[t.id];if(0===this._currentQuestionIndex?(this._disablePrev(),this._enableNext()):this._currentQuestionIndex===this._questions.length-1?(this._disableNext(),this._enablePrev()):(this._enablePrev(),this._enableNext()),1==this.options.immediateFeedback&&1!=this.options.disableOptionAfterSelect)switch(1!=this.options.disableNextUntilSuccess||void 0!=s&&1==s.isCorrect||this._disableNext(),this.options.disableEndActionUntil){case this.DISABLE_END.beforeAnswerAll:Object.keys(this._runtime),this._questions.length;break;case this.DISABLE_END.beforeAnswerAllCorrect:var i=0,e=this._runtime;for(var n in e){e[n].isCorrect&&i++}i==this._questions.length?this._enableEnd():this._disableEnd()}},_onEndShowResult:function(t){t.data.instance.end()},getMaxPoints:function(){return this._maxScore},getId:function(){return this.element.attr("id")},next:function(){return void 0!=this._currentQuestionIndex?this.goTo(this._currentQuestionIndex+1):this.goTo(0)},prev:function(){return void 0!=this._currentQuestionIndex?this.goTo(this._currentQuestionIndex-1):this.goTo(0)},goTo:function(t){var s,i=this;if(this._state===this.STATES.running||this._state==this.STATES.review){var e=this._questions[t],n=this._currentQuestionIndex,o=this._questions[n];if(void 0!=e){if(void 0==o||o!=e){var a=$.Deferred();s=a.promise(),this._disableNext(),this._disablePrev(),this._currentQuestionIndex=t,t==this._questions.length-1?(this.element.removeClass(this.options.classes.firstQuestion),this.element.addClass(this.options.classes.lastQuestion)):0==t?(this.element.removeClass(this.options.classes.lastQuestion),this.element.addClass(this.options.classes.firstQuestion)):(this.element.removeClass(this.options.classes.firstQuestion),this.element.removeClass(this.options.classes.lastQuestion)),this.element.attr(this.ATTR_CURRENT_QUESTION,t),o?this._hide(o.$element).then(function(){i._show(e.$element).then(i._onQuestionTransitionEnd.bind(i,o,e,a))}):this._show(e.$element).then(this._onQuestionTransitionEnd.bind(this,o,e,a))}}else if(o){var r=$.Deferred();s=r.promise(),this._hide(o.$element).then(this._onQuestionTransitionEnd.bind(this,o,null,r))}}return s},getQuestions:function(){return this._questions},getQuestionByIndex:function(t){return this._questions[t]},getQuestionById:function(t){return this.getQuestionByIndex(this._questionsMap[t])},getOptions:function(t){return(this.getQuestionById(t)||{}).options},getOptionByIndex:function(t,s){var i,e=this.getOptions(t);return e&&(i=e[s]),i},getOptionById:function(t,s){var i,e=this.getQuestionById(t);return e&&(i=e.options[e.optionsMap[s]]),i},update:function(){},redrawProperties:function(){this._renderOptions()},reset:function(){this._runtime={},this.element.removeAttr(this.ATTR_CURRENT_QUESTION),this.element.removeClass(this.options.classes.firstQuestion),this.element.removeClass(this.options.classes.lastQuestion),this._currentQuestionIndex=null,this._$questions.hide(),this._$questions.first().show(),this._$questions.find("input").prop("checked",!1).removeAttr("disabled"),this._$questions.find("."+this.options.classes.disabled).removeClass(this.options.classes.disabled),this.element.find(this.QUERY_FEEDBACK).hide(),this.element.find("."+this.options.classes.questionCorrect).removeClass(this.options.classes.questionCorrect),this.element.find("."+this.options.classes.questionIncorrect).removeClass(this.options.classes.questionIncorrect),this.element.find("."+this.options.classes.selected).removeClass(this.options.classes.selected)},start:function(){1!=this.options.disabled&&this._state===this.STATES.off&&(this._changeState(this.STATES.running),this.element.trigger(this.ON_START,[this]),this._runtime={},this._animationStart().then(this._onAnimationStartEnd))},showResult:function(t){return!!(t&&this.options.showResult&&this._$result.length>0)&&(this._changeState(this.STATES.result),this._renderVar(this.QUERY_RENDER_RESULT,"jqQuizResultItem",t,this._$result),this._$result.dialog(this.options.dialog).one("dialogclose",{instance:this},this._onEndShowResult),!0)},showCorrection:function(){if(this.options.showCorrection){for(var t=this._questions,s=0,i=t.length;s<i;s++){for(var e=t[s],n=e.options,o=0,a=n.length;o<a;o++){var r=n[o];this._showOptionStatus(e.id,r.id)}this._disableQuestionOptionsField(e.id)}return this._changeState(this.STATES.review),this.goTo(0),!0}return!1},_disableAllQuestions:function(){for(var t=this._questions,s=0,i=t.length;s<i;s++){var e=t[s];this._disableQuestionOptionsField(e.id)}},end:function(){if(this._state===this.STATES.running){var t=this._calificate();return this.lastCalification=t,this._disableAllQuestions(),this.element.trigger(this.ON_END,[this,t]),this.showResult(t)||this.showCorrection()||(this._changeState(this.STATES.off),this._animationStop().then(this._onAnimationEndEnd)),t}return this._state==this.STATES.result?(this.showCorrection()||(this._changeState(this.STATES.off),this._animationStop().then(this._onAnimationEndEnd)),this.lastCalification):this._state==this.STATES.review?(this._changeState(this.STATES.off),this._animationStop().then(this._onAnimationEndEnd),this.lastCalification):void 0},_changeState:function(t){switch(t){case this.STATES.review:this._state=t,this.element.removeClass(this.options.classes.stateRunning+" "+this.options.classes.stateResult),this.element.addClass(this.options.classes.stateReview);break;case this.STATES.running:this._state=t,this.element.removeClass(this.options.classes.stateReview+" "+this.options.classes.stateResult),this.element.addClass(this.options.classes.stateRunning);break;case this.STATES.result:this._state=t,this.element.removeClass(this.options.classes.stateReview+" "+this.options.classes.stateRunning),this.element.addClass(this.options.classes.stateResult);break;case this.STATES.off:this.element.removeClass(this.options.classes.stateResult+" "+this.options.classes.stateReview+" "+this.options.classes.stateRunning),this._state=t}},_disable:function(){this._disableStart()},_enable:function(){this._enableStart()},disable:function(){this._super(),this._disable()},enable:function(){this._super(),this._enable()},destroy:function(){this._$wrapper.removeClass(this.options.classes.wrapper),this._$header.removeClass(this.options.classes.header),this._$body.removeClass(this.options.classes.body),this._$body.show(),this._$properties.removeClass(this.options.classes.properties),this._$questionsWrapper.removeClass(this.options.classes.questions),this._$questions.removeClass(this.options.classes.question),this._$questions.show(),this._$startBtn.removeClass(this.options.classes.button+" "+this.options.classes.startBtn),this._$nextBtn.removeClass(this.options.classes.button+" "+this.options.classes.nextBtn),this._$prevBtn.removeClass(this.options.classes.button+" "+this.options.classes.prevBtn),this._$endBtn.removeClass(this.options.classes.button+" "+this.options.classes.endBtn),this._$result.removeClass(this.options.classes.result),this._$result.data("uiDialog")&&this._$result.dialog("destroy")}})});
